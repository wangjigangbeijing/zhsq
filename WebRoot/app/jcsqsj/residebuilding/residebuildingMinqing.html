
<section class="content">
      <div class="container-fluid" id="minqingDiv">
        
		<!--div class="row">
          <div class="col-12">
            <div class="card card-primary">
              <div class="card-header">
                <h3 class="card-title">A小区1号楼1单元民情图</h3>
              </div>
              <div class="card-body">
                <div class="row">
                  <div class="col-sm-2">
                    <div class="position-relative p-3 " style="height: 80px; background:#ececec">
                      <div class="ribbon-wrapper">
                        <div class="ribbon bg-primary">
                          101
                        </div>
                      </div>
                      张三，李四，王五 <br />
                      <small>
                        <i class="fas fa-heart" style="color:orange"  ></i>
                        <i class="fas fa-wheelchair" style="color:orange" > </i>
                        <i class="fas fa-star" style="color:orange" ></i>
                        <i class="fas fa-user" style="color:orange" ></i>
                      </small>
                    </div>
                  </div>
                  <div class="col-sm-2">
                    <div class="position-relative p-3 " style="height: 80px; background:#ececec">
                      <div class="ribbon-wrapper">
                        <div class="ribbon bg-primary">
                          102
                        </div>
                      </div>
                      张三，李四，王五 <br />
                      <small>
                        <i class="fas fa-heart" style="color:orange"  ></i>
                        <i class="fas fa-wheelchair" style="color:orange" > </i>
                        <i class="fas fa-star" style="color:orange" ></i>
                        <i class="fas fa-user" style="color:orange" ></i>
                      </small>
                    </div>
                  </div>
                  <div class="col-sm-2">
                    <div class="position-relative p-3 " style="height: 80px; background:#ececec">
                      <div class="ribbon-wrapper">
                        <div class="ribbon bg-primary">
                          103
                        </div>
                      </div>
                      张三，李四，王五 <br />
                      <small>
                        <i class="fas fa-heart" style="color:orange"  ></i>
                        <i class="fas fa-wheelchair" style="color:orange" > </i>
                        <i class="fas fa-star" style="color:orange" ></i>
                        <i class="fas fa-user" style="color:orange" ></i>
                      </small>
                    </div>
                  </div>
                  <div class="col-sm-2">
                    <div class="position-relative p-3 " style="height: 80px; background:#ececec">
                      <div class="ribbon-wrapper">
                        <div class="ribbon bg-primary">
                          103
                        </div>
                      </div>
                      张三，李四，王五 <br />
                      <small>
                        <i class="fas fa-heart" style="color:orange"  ></i>
                        <i class="fas fa-wheelchair" style="color:orange" > </i>
                        <i class="fas fa-star" style="color:orange" ></i>
                        <i class="fas fa-user" style="color:orange" ></i>
                      </small>
                    </div>
                  </div>
                   <div class="col-sm-2">
                    <div class="position-relative p-3 " style="height: 80px; background:#ececec">
                      <div class="ribbon-wrapper">
                        <div class="ribbon bg-primary">
                          103
                        </div>
                      </div>
                      张三，李四，王五 <br />
                      <small>
                        <i class="fas fa-heart" style="color:orange"  ></i>
                        <i class="fas fa-wheelchair" style="color:orange" > </i>
                        <i class="fas fa-star" style="color:orange" ></i>
                        <i class="fas fa-user" style="color:orange" ></i>
                      </small>
                    </div>
                  </div>
                  <div class="col-sm-2">
                    <div class="position-relative p-3 " style="height: 80px; background:#ececec">
                      <div class="ribbon-wrapper">
                        <div class="ribbon bg-primary">
                          103
                        </div>
                      </div>
                      张三，李四，王五 <br />
                      <small>
                        <i class="fas fa-heart" style="color:orange"  ></i>
                        <i class="fas fa-wheelchair" style="color:orange" > </i>
                        <i class="fas fa-star" style="color:orange" ></i>
                        <i class="fas fa-user" style="color:orange" ></i>
                      </small>
                    </div>
                  </div>
                </div>

                
                <div class="row mt-1">
                  <div class="col-sm-2">
                    <div class="position-relative p-3 " style="height: 80px; background:#ececec">
                      <div class="ribbon-wrapper">
                        <div class="ribbon bg-primary">
                          101
                        </div>
                      </div>
                      张三，李四，王五 <br />
                      <small>
                        <i class="fas fa-heart" style="color:orange"  ></i>
                        <i class="fas fa-wheelchair" style="color:orange" > </i>
                        <i class="fas fa-star" style="color:orange" ></i>
                        <i class="fas fa-user" style="color:orange" ></i>
                      </small>
                    </div>
                  </div>
                  <div class="col-sm-2">
                    <div class="position-relative p-3 " style="height: 80px; background:#ececec">
                      <div class="ribbon-wrapper">
                        <div class="ribbon bg-primary">
                          102
                        </div>
                      </div>
                      张三，李四，王五<br />
                      <small>
                        <i class="fas fa-heart" style="color:orange"  ></i>
                        <i class="fas fa-wheelchair" style="color:orange" > </i>
                        <i class="fas fa-star" style="color:orange" ></i>
                        <i class="fas fa-user" style="color:orange" ></i>
                      </small>
                    </div>
                  </div>
                  <div class="col-sm-2">
                    <div class="position-relative p-3 " style="height: 80px; background:#ececec">
                      <div class="ribbon-wrapper">
                        <div class="ribbon bg-primary">
                          103
                        </div>
                      </div>
                      张三，李四，王五 <br />
                      <small>
                        <i class="fas fa-heart" style="color:orange"  ></i>
                        <i class="fas fa-wheelchair" style="color:orange" > </i>
                        <i class="fas fa-star" style="color:orange" ></i>
                        <i class="fas fa-user" style="color:orange" ></i>
                      </small>
                    </div>
                  </div>
                  <div class="col-sm-2">
                    <div class="position-relative p-3 " style="height: 80px; background:#ececec">
                      <div class="ribbon-wrapper">
                        <div class="ribbon bg-primary">
                          103
                        </div>
                      </div>
                      张三，李四，王五 <br />
                      <small>
                        <i class="fas fa-heart" style="color:orange"  ></i>
                        <i class="fas fa-wheelchair" style="color:orange" > </i>
                        <i class="fas fa-star" style="color:orange" ></i>
                        <i class="fas fa-user" style="color:orange" ></i>
                      </small>
                    </div>
                  </div>
                   <div class="col-sm-2">
                    <div class="position-relative p-3 " style="height: 80px; background:#ececec">
                      <div class="ribbon-wrapper">
                        <div class="ribbon bg-primary">
                          103
                        </div>
                      </div>
                      张三，李四，王五 <br />
                      <small>
                        <i class="fas fa-heart" style="color:orange"  ></i>
                        <i class="fas fa-wheelchair" style="color:orange" > </i>
                        <i class="fas fa-star" style="color:orange" ></i>
                        <i class="fas fa-user" style="color:orange" ></i>
                      </small>
                    </div>
                  </div>
                  <div class="col-sm-2">
                    <div class="position-relative p-3 " style="height: 80px; background:#ececec">
                      <div class="ribbon-wrapper">
                        <div class="ribbon bg-primary">
                          103
                        </div>
                      </div>
                      张三，李四，王五 <br />
                      <small>
                        <i class="fas fa-heart" style="color:orange"  ></i>
                        <i class="fas fa-wheelchair" style="color:orange" > </i>
                        <i class="fas fa-star" style="color:orange" ></i>
                        <i class="fas fa-user" style="color:orange" ></i>
                      </small>
                    </div>
                  </div>
                </div>

                </div>
              </div>
            </div>
          </div-->
		  
		  
		
      </div>
	  
	  <div class="card-footer">
				
		  <button class="btn btn-primary float-right" type="button" onclick="gobackPage();">返回</button>
		  
		</div>
    </section>
	
	
<script>

function gobackPage()
{
	curId = '';
	
	$('#main-content').load("./jcsqsj/residebuilding/residebuilding.html", function () {
		
    });
}

$(document).ready(function ()
{
	$.get(getContextPath()+"/residebuildingController/getMinqing?id="+curId,
		function(result){
			var obj = jQuery.parseJSON(result);  
			if(obj.success)
			{
				$('#minqingDiv').empty();
				
				var divWidth = $('#minqingDiv').width();
				
				var roomWidth = (divWidth - 50)/obj.maxRoomNum;
				
				if(roomWidth > 200)
					roomWidth = 200;
					
				if(roomWidth < 100)
					roomWidth = 100;	
					
				var units = obj.units;
				
				var buildingName = obj.name;
				
				for(var i=0;i<units.length;i++)
				{
					var unit = units[i];
					
					var unitDiv = '<div class="row"><div class="col-12"><div class="card card-primary"><div class="card-header"><h3 class="card-title">'+buildingName+unit.name+'民情图</h3> <button class="btn btn-primary float-right" type="button" onclick="gobackPage();">返回</button></div><div class="card-body">';
					
					var rooms = unit.rooms;
					
					var curLevel = '';
					
					var endDiv = '';
					
					var levelDiv = '';
					
					var levelArr = new Array();
					
					//for(var j=rooms.length-1;j>=0;j--)
					for(var j=0;j<rooms.length;j++)
					{
						var room = rooms[j];
						
						if(curLevel != room.level)
						{
							if(j != rooms.length)
							{
								levelDiv += '</div>';
								
								levelArr.push(levelDiv);
							}
								
							curLevel = room.level;
							
							levelDiv = '<div class="row">';//每一层增加一个divrow
						}
						
						var characteristics = '';
						
						var peoplecharacteristics = room.peoplecharacteristics;
						
						if(peoplecharacteristics != undefined && peoplecharacteristics != null && peoplecharacteristics != '')
						{
							var characteristicsArr = peoplecharacteristics.split(',');
							
							for(var k=0;k<characteristicsArr.length;k++)
							{
								if(characteristicsArr[k] != '')
									characteristics += '<i><img src="../images/icon/mqicon/'+characteristicsArr[k]+'.png" alt="'+characteristicsArr[k]+'" width="28px"  /></i>';	
							}
						}
						
						var residentNameArr = room.residentNames.split(',');
						var residentIdArr = room.residentIds.split(',');
						
						var residentStr = '';
						
						for(var k=0;k<residentNameArr.length;k++)
						{
							residentStr += '<a href="javascript:clickResident(\''+residentIdArr[k]+'\')" >'+residentNameArr[k]+'</a>,';
						}
						
						levelDiv += '<div class="float-right" style="padding-top:10px;padding-left:5px;width:'+roomWidth+'px;">'+
							'<div class="position-relative p-3 " style="height: 75px; background:#ececec">'+
							  '<div class="ribbon-wrapper">'+
								'<div class="ribbon bg-primary"><a href="javascript:clickRoom(\''+room.roomId+'\')" >'+
								  room.number+
								'</a></div>'+
							  '</div><small>'+
							  //room.residentNames+
							  
							  residentStr +'</small><br />'+
							  
							  '<small>'+
								characteristics+
							  '</small>'+
							'</div>'+
						  '</div>';
					}
					
					for(var k=levelArr.length-1;k>=0;k--)
					{
						var levelDiv = levelArr[k];
					
						unitDiv += levelDiv;
					}
					
					unitDiv += '</div>';
					
					unitDiv += '</div></div></div></div>';
					
					$('#minqingDiv').append(unitDiv);
				}
			}
		});
});

function clickRoom(roomId)
{
	window.open('./roomDetailPopup.html?roomId='+roomId+'&roomNum='+roomNum+'&residentBuildingId='+curId, 
						'newwindow', 'fullscreen=1, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no');
}

function clickResident(residentId)
{
	window.open('./residentDetailPopup.html?residentId='+residentId, 
						'newwindow', 'fullscreen=1, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no');
}
</script>
