

<script src="./nfw/jsjbfwFlowDetail.js"></script>


    <section class="content">
      <div class="container-fluid">
        <div class="row">
         
          <!-- /.col -->
          <div class="col-md-9">
            <div class="card">
              <div class="card-header p-2">
                <ul class="nav nav-pills">
                  <li class="nav-item"><a class="nav-link active" href="#activity" data-toggle="tab">事件处理</a></li>
                
                  <li class="nav-item"><a class="nav-link" href="#timeline" data-toggle="tab">流程图</a></li>
                </ul>
              </div><!-- /.card-header -->
              <div class="card-body">

                <div class="invoice p-3 mb-3">
                  <!-- title row -->
                  <div class="row">
                    <div class="col-12">
                      <h4>
                        <i class="fas fa-globe"></i> 张三办理老年证
                        <small class="float-right">编号：1213345</small>
                      </h4>
                    </div>
                    <!-- /.col -->
                  </div>
                  <!-- info row -->
                  <div class="row invoice-info">
                    <div class="col-sm-4 invoice-col">
                      <b>Invoice #007612</b><br>
                      <b>Order ID:</b> 4F3S8J<br>
                      <b>Payment Due:</b> 2/22/2014<br>
                      <b>Account:</b> 968-34567
                    </div>

                    <div class="col-sm-4 invoice-col">
                      <b>Invoice #007612</b><br>
                      <b>Order ID:</b> 4F3S8J<br>
                      <b>Payment Due:</b> 2/22/2014<br>
                      <b>Account:</b> 968-34567
                    </div>
                
                    <!-- /.col -->
                    <div class="col-sm-4 invoice-col">
                      <b>Invoice #007612</b><br>
                      <b>Order ID:</b> 4F3S8J<br>
                      <b>Payment Due:</b> 2/22/2014<br>
                      <b>Account:</b> 968-34567
                    </div>
                    <!-- /.col -->
                  </div>
                  <!-- /.row -->
    

    
           
                  <!-- /.row -->
    
                  <!-- this row will not appear when printing -->
          
                </div>

                <div class="tab-content">
                  <div class="active tab-pane" id="activity">
                    <!-- Post -->
                    <div class="post">
                      
                 

                   

         
                    </div>
                    <!-- /.post -->

                    <!-- Post -->
                    <div class="post clearfix">
                      

                      <form id="flowfrm" class="form-horizontal">
               
                     <h4>当前节点：<span id="curnode">社区处理</span></h4>
                     <br>
                                 
                        <div class="form-group row">
                          <label for="inputName2" class="col-sm-2 col-form-label">选择部门</label>
                          <div class="col-sm-10">
                            <input type="text" class="form-control" id="inputName2" placeholder="选择部门">
                          </div>
                        </div>
                        <div class="form-group row">
                          <label for="inputExperience" class="col-sm-2 col-form-label">办理意见</label>
                          <div class="col-sm-10">
                            <textarea class="form-control" id="desc" name="desc" placeholder="办理意见"></textarea>
                          </div>
                        </div>
                        <div class="form-group row">
                          <label for="inputSkills" class="col-sm-2 col-form-label">附件</label>
                          <div class="col-sm-10">
                      
                          
                              <div class="input-group">
                                <div class="custom-file">
                                  <input type="file" class="custom-file-input" id="exampleInputFile">
                                  <label class="custom-file-label" for="exampleInputFile">选择附件</label>
                                </div>
                                <div class="input-group-append">
                                  <span class="input-group-text" id="">上传</span>
                                </div>
                              </div>
                           
                          </div>
                        </div>
                   
                        <div class="form-group row">
                          <div class="offset-sm-2 col-sm-10">
                            <button type="button" class="btn btn-danger" id="btn_back" onclick="backData()">回退</button>
						  
						  <button type="button" class="btn btn-success" style="margin-left:10px;" id="btn_goon" onclick="goondata()">同意</button>
                          </div>
                        </div>
                      </form>

                    </div>
                    <!-- /.post -->

                
                  </div>
                  <!-- /.tab-pane -->
                  <div class="tab-pane" id="timeline">
                    <!-- The timeline -->
                    <div class="timeline timeline-inverse">
                      <!-- timeline time label -->
                     
                 
                  
                      <!-- END timeline item -->
                      <!-- timeline time label -->
                    
                      <!-- /.timeline-label -->
                      <!-- timeline item -->
              
                      <!-- END timeline item -->
                      <div>
                       这里放流程图的图片，可以在数据库里定义图片URL
                      </div>
                    </div>
                  </div>
                  <!-- /.tab-pane -->

                  <div class="tab-pane" id="settings">

                    <h4>
                      当前节点：社区初审
                    </h4>

                    <form class="form-horizontal">
               
                     
                     
                      <div class="form-group row">
                        <label for="inputName" class="col-sm-2 col-form-label">操作</label>
                        <div class="col-sm-10">
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="radio1">
                            <label class="form-check-label">同意</label>
                          </div>
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="radio1">
                            <label class="form-check-label">退回</label>
                          </div>
                        </div>
                      </div>
                  
                      <div class="form-group row">
                        <label for="inputName2" class="col-sm-2 col-form-label">选择部门</label>
                        <div class="col-sm-10">
                          <input type="text" class="form-control" id="inputName2" placeholder="Name">
                        </div>
                      </div>
                      <div class="form-group row">
                        <label for="inputExperience" class="col-sm-2 col-form-label">办理意见</label>
                        <div class="col-sm-10">
                          <textarea class="form-control" id="inputExperience" placeholder="Experience"></textarea>
                        </div>
                      </div>
                      <div class="form-group row">
                        <label for="inputSkills" class="col-sm-2 col-form-label">附件</label>
                        <div class="col-sm-10">
                    
                        
                            <div class="input-group">
                              <div class="custom-file">
                                <input type="file" class="custom-file-input" id="exampleInputFile">
                                <label class="custom-file-label" for="exampleInputFile">Choose file</label>
                              </div>
                              <div class="input-group-append">
                                <span class="input-group-text" id="">上传</span>
                              </div>
                            </div>
                         
                        </div>
                      </div>
                 
                      <div class="form-group row">
                        <div class="offset-sm-2 col-sm-10">
                          <button type="submit" class="btn btn-warn">回退</button>
						  
						  <button type="submit" class="btn btn-primary">同意</button>
                        </div>
                      </div>
                    </form>
                  </div>
                  <!-- /.tab-pane -->
                </div>
                <!-- /.tab-content -->
              </div><!-- /.card-body -->
            </div>
            <!-- /.nav-tabs-custom -->
          </div>

          <div class="col-md-3">

            <!-- Profile Image -->
            <div class="card card-primary card-outline">
              <div class="card-body box-profile">
               <ul class="list-group list-group-unbordered mb-3">
                  <li class="list-group-item">
                    <b>当前状态</b> <a class="float-right" id="showstatus">待处理</a>
                  </li>
                  <li class="list-group-item">
                    <b>当前处理部门</b> <a class="float-right">aaa社区</a>
                  </li>
                  <li class="list-group-item">
                    <b>当前操作人</b> <a class="float-right">张三</a>
                  </li>
                </ul>

              
              </div>
              <!-- /.card-body -->
            </div>
            <!-- /.card -->

            <!-- About Me Box -->
            <div class="card card-primary">
              <div class="card-header">
                <h3 class="card-title">处理过程</h3>
              </div>
              <!-- /.card-header -->
              <br>
              <div class="timeline timeline-inverse">
                <!-- timeline time label -->
             
                <!-- /.timeline-label -->
                <!-- timeline item -->
                <div>
                  <i class="fas fa-envelope bg-primary"></i>

                  <div class="timeline-item">
                    <span class="time"><i class="far fa-user"></i> 张三</span>

                    <h3 class="timeline-header"><a href="#">事件登记</a> </h3>

                    <div class="timeline-body">
                     操作： 同意 
                     <br> 意见： 撒打发手动阀手动阀手动阀asdfasdfasdf啊手动阀手动阀手动阀手动阀手动阀萨芬大是大非手动阀
                     <br> 附件：xxxx.jpg 
                     
                    </div>
                    <div class="timeline-footer">
                      <span class="time"><i class="far fa-clock"></i> 2020-10-01 12:05:21</span>
                     </div>
                  </div>
                </div>
                <!-- END timeline item -->
                <!-- timeline item -->
                <div>
                  <i class="fas fa-user bg-info"></i>

                  <div class="timeline-item">
                    <span class="time"><i class="far fa-user"></i> 张三</span>

                    <h3 class="timeline-header"><a href="#">事件登记</a> </h3>

                    <div class="timeline-body">
                     操作： 同意 
                     <br> 意见： 撒打发手动阀手动阀手动阀asdfasdfasdf啊手动阀手动阀手动阀手动阀手动阀萨芬大是大非手动阀
                     <br> 附件：xxxx.jpg 
                     
                    </div>
                    <div class="timeline-footer">
                      <span class="time"><i class="far fa-clock"></i> 2020-10-01 12:05:21</span>
                     </div>
                  </div>
                </div>
                <!-- END timeline item -->
                <!-- timeline item -->
                <div>
                  <i class="fas fa-comments bg-warning"></i>

                  <div class="timeline-item">
                    <span class="time"><i class="far fa-user"></i> 张三</span>

                    <h3 class="timeline-header"><a href="#">事件登记</a> </h3>

                    <div class="timeline-body">
                     操作： 同意 
                     <br> 意见： 撒打发手动阀手动阀手动阀asdfasdfasdf啊手动阀手动阀手动阀手动阀手动阀萨芬大是大非手动阀
                     <br> 附件：xxxx.jpg 
                     
                    </div>
                    <div class="timeline-footer">
                      <span class="time"><i class="far fa-clock"></i> 2020-10-01 12:05:21</span>
                     </div>
                  </div>
                </div>
                <!-- END timeline item -->
                <!-- timeline time label -->
             
                <!-- /.timeline-label -->
                <!-- timeline item -->
                <div>
                  <i class="fas fa-camera bg-purple"></i>

                  <div class="timeline-item">
                    <span class="time"><i class="far fa-user"></i> 张三</span>

                    <h3 class="timeline-header"><a href="#">事件登记</a> </h3>

                    <div class="timeline-body">
                     操作： 同意 
                     <br> 意见： 撒打发手动阀手动阀手动阀asdfasdfasdf啊手动阀手动阀手动阀手动阀手动阀萨芬大是大非手动阀
                     <br> 附件：xxxx.jpg 
                     
                    </div>
                    <div class="timeline-footer">
                      <span class="time"><i class="far fa-clock"></i> 2020-10-01 12:05:21</span>
                     </div>
                  </div>
                </div>
                <!-- END timeline item -->
                <div>
                  <i class="far fa-clock bg-gray"></i>
                </div>
              </div>
        
              <!-- /.card-body -->
            </div>
            <!-- /.card -->
          </div>
          <!-- /.col -->
        </div>
        <!-- /.row -->
      </div><!-- /.container-fluid -->
    </section>
    <!-- /.content -->
  </div>
	
<script>


var uploaderpictures = WebUploader.create({
	auto: true,
// swf文件路径
//swf: BASE_URL + '/js/Uploader.swf',
// 文件接收服务端
server: getContextPath()+'/fileController/upload',
// 选择文件的按钮。可选。
// 内部根据当前运行是创建，可能是input元素，也可能是flash.
pick: '#picturespick',
formData:{
attributeName:'pictures'
}
});
uploaderpictures.on( 'fileQueued', function( file ) {
	$('#'+file.source._refer[0].id+'table').append('<tr><td>'+file.name+'</td><td id='+file.id+'>等待上传...</td>'+
						"<td><button type='button' id='"+file.id+"Button' class='btn btn-success btn-xs' onclick='javascript:downloadAttach();return false;'><i class='fa fa-check'></i></button></td>"+
						'</tr>');
});
uploaderpictures.on( 'uploadSuccess', function( file,response ) {
	$( '#'+response.attributeName ).val(response.fileName+VALUE_SPLITTER+$('#'+response.attributeName ).val());
	console.log($( '#'+response.attributeName ).val());
	$( '#'+file.id ).text('已上传');
	$('#'+file.id+'Button').attr('onclick', onclick='javascript:downloadAttach("'+response.fileName+'");return false;');
});
uploaderpictures.on( 'uploadError', function( file,response ) {
});	



function searchResident()
{
	var residentName = $('#residentNameQry').val();
	
	$.get(getContextPath()+'/residentController/load?name='+residentName,
	function(result){
		$('#btnSearch').removeAttr('disabled');
		var obj = jQuery.parseJSON(result);  
		if(obj.success)
		{
			dataTable = $('#dataTable').dataTable( {
				"processing": true,
				"bJQueryUI": false,
				"bFilter": false,
				"bStateSave":true,
				"bAutoWidth": false, //自适应宽度 
				iDisplayLength: 10,
				lengthChange: false,
				"bProcessing": true, 
				"bDestroy":true,
				"bSort": false, //是否使用排序 		
				/*"oLanguage": { 
					"sProcessing": "正在加载中......", 
					"sLengthMenu": "每页显示 _MENU_ 条记录", 
					"sZeroRecords": "对不起，查询不到相关数据！", 
					"sInfoEmpty":"",
					"sInfo": "当前显示 _START_ 到 _END_ 条，共 _TOTAL_ 条记录", 
					"sInfoFiltered": "数据表中共为 _MAX_ 条记录", 
					"sSearch": "搜索", 
					"oPaginate":  
					{ 
						"sFirst": "首页", 
						"sPrevious": "上一页", 
						"sNext": "下一页", 
						"sLast": "末页" 
					}
				}, *///多语言配置					
				"data":obj.list,
				"columns": [
					{ 'data': 'name' ,'sClass':'text-center'},
					{ 'data': 'idnumber' ,'sClass':'text-center'},
					{ 'data': 'mobile' ,'sClass':'text-center'},
					{ 'data': 'address' ,'sClass':'text-center'}
				],
				columnDefs: [
					{
					className: 'control',
					orderable: false,
					targets:  0,//从0开始
					mRender : function(data,type,full){
						var btn = "<a href=\"#\" onclick=\"selectUser('"+full.name+"','"+full.idnumber+"','"+full.mobile+"','"+full.address+"')\" data-toggle=\"tooltip\" title=\"查看\">"+full.name+"</a>";
						return btn;
					}
					}
				]
			} );
		}
	});
}

function selectUser(name,idnumber,mobile,address)
{
	$('#name').val(name);
	$('#idnumber').val(idnumber);
	$('#mobile').val(mobile);
	$('#address').val(address);
}

</script>
